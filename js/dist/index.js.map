{"version":3,"sources":["../src/index.ts","../src/client.ts","../src/types.ts"],"sourcesContent":["export * from './client';\nexport * from './types';\n","import { execa } from 'execa';\nimport { FinetuneConfig, FinetuneConfigSchema, GenerationOptions } from './types';\n\nexport class Langtune {\n    private cliPath: string;\n    private apiKey?: string;\n\n    constructor(options: { cliPath?: string, apiKey?: string } = {}) {\n        this.cliPath = options.cliPath || 'langtune';\n        this.apiKey = options.apiKey;\n    }\n\n    private getEnv() {\n        return {\n            ...process.env,\n            LANGTUNE_API_KEY: this.apiKey || process.env.LANGTUNE_API_KEY\n        };\n    }\n\n    /**\n     * Run a fine-tuning job using the local CLI\n     */\n    async finetune(config: FinetuneConfig): Promise<void> {\n        const validated = FinetuneConfigSchema.parse(config);\n\n        // Construct CLI arguments\n        const args = [\n            'train',\n            '--model', validated.model,\n            '--train-file', validated.trainFile,\n            '--preset', validated.preset,\n            '--epochs', validated.epochs.toString(),\n            '--batch-size', validated.batchSize.toString(),\n            '--learning-rate', validated.learningRate.toString(),\n            '--lora-rank', validated.loraRank.toString(),\n            '--output-dir', validated.outputDir,\n        ];\n\n        if (validated.useTriton) {\n            args.push('--use-triton');\n        }\n\n        if (validated.useLisa) {\n            args.push('--use-lisa');\n        }\n\n        try {\n            await execa(this.cliPath, args, {\n                stdio: 'inherit',\n                env: this.getEnv()\n            });\n        } catch (error) {\n            throw new Error(`Langtune fine-tuning failed: ${error}`);\n        }\n    }\n\n    /**\n     * Generate text using a model\n     */\n    async generate(modelPath: string, options: GenerationOptions): Promise<string> {\n        const args = [\n            'generate',\n            '--model', modelPath,\n            '--prompt', options.prompt,\n        ];\n\n        if (options.maxTokens) {\n            args.push('--max-tokens', options.maxTokens.toString());\n        }\n\n        if (options.temperature) {\n            args.push('--temperature', options.temperature.toString());\n        }\n\n        try {\n            const { stdout } = await execa(this.cliPath, args, {\n                env: this.getEnv()\n            });\n            return stdout;\n        } catch (error) {\n            throw new Error(`Langtune generation failed: ${error}`);\n        }\n    }\n}\n","import { z } from 'zod';\n\nexport const FinetuneConfigSchema = z.object({\n    model: z.string(),\n    trainFile: z.string(),\n    preset: z.string().optional().default('small'),\n    epochs: z.number().optional().default(3),\n    batchSize: z.number().optional().default(4),\n    learningRate: z.number().optional().default(2e-4),\n    loraRank: z.number().optional().default(16),\n    outputDir: z.string().optional().default('./output'),\n    useTriton: z.boolean().optional().default(false),\n    useLisa: z.boolean().optional().default(false),\n});\n\nexport type FinetuneConfig = z.infer<typeof FinetuneConfigSchema>;\n\nexport interface GenerationOptions {\n    prompt: string;\n    maxTokens?: number;\n    temperature?: number;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,mBAAsB;;;ACAtB,iBAAkB;AAEX,IAAM,uBAAuB,aAAE,OAAO;AAAA,EACzC,OAAO,aAAE,OAAO;AAAA,EAChB,WAAW,aAAE,OAAO;AAAA,EACpB,QAAQ,aAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,OAAO;AAAA,EAC7C,QAAQ,aAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,EACvC,WAAW,aAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,CAAC;AAAA,EAC1C,cAAc,aAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,IAAI;AAAA,EAChD,UAAU,aAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE;AAAA,EAC1C,WAAW,aAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,UAAU;AAAA,EACnD,WAAW,aAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,KAAK;AAAA,EAC/C,SAAS,aAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,KAAK;AACjD,CAAC;;;ADVM,IAAM,WAAN,MAAe;AAAA,EAIlB,YAAY,UAAiD,CAAC,GAAG;AAC7D,SAAK,UAAU,QAAQ,WAAW;AAClC,SAAK,SAAS,QAAQ;AAAA,EAC1B;AAAA,EAEQ,SAAS;AACb,WAAO;AAAA,MACH,GAAG,QAAQ;AAAA,MACX,kBAAkB,KAAK,UAAU,QAAQ,IAAI;AAAA,IACjD;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,QAAuC;AAClD,UAAM,YAAY,qBAAqB,MAAM,MAAM;AAGnD,UAAM,OAAO;AAAA,MACT;AAAA,MACA;AAAA,MAAW,UAAU;AAAA,MACrB;AAAA,MAAgB,UAAU;AAAA,MAC1B;AAAA,MAAY,UAAU;AAAA,MACtB;AAAA,MAAY,UAAU,OAAO,SAAS;AAAA,MACtC;AAAA,MAAgB,UAAU,UAAU,SAAS;AAAA,MAC7C;AAAA,MAAmB,UAAU,aAAa,SAAS;AAAA,MACnD;AAAA,MAAe,UAAU,SAAS,SAAS;AAAA,MAC3C;AAAA,MAAgB,UAAU;AAAA,IAC9B;AAEA,QAAI,UAAU,WAAW;AACrB,WAAK,KAAK,cAAc;AAAA,IAC5B;AAEA,QAAI,UAAU,SAAS;AACnB,WAAK,KAAK,YAAY;AAAA,IAC1B;AAEA,QAAI;AACA,gBAAM,oBAAM,KAAK,SAAS,MAAM;AAAA,QAC5B,OAAO;AAAA,QACP,KAAK,KAAK,OAAO;AAAA,MACrB,CAAC;AAAA,IACL,SAAS,OAAO;AACZ,YAAM,IAAI,MAAM,gCAAgC,KAAK,EAAE;AAAA,IAC3D;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,WAAmB,SAA6C;AAC3E,UAAM,OAAO;AAAA,MACT;AAAA,MACA;AAAA,MAAW;AAAA,MACX;AAAA,MAAY,QAAQ;AAAA,IACxB;AAEA,QAAI,QAAQ,WAAW;AACnB,WAAK,KAAK,gBAAgB,QAAQ,UAAU,SAAS,CAAC;AAAA,IAC1D;AAEA,QAAI,QAAQ,aAAa;AACrB,WAAK,KAAK,iBAAiB,QAAQ,YAAY,SAAS,CAAC;AAAA,IAC7D;AAEA,QAAI;AACA,YAAM,EAAE,OAAO,IAAI,UAAM,oBAAM,KAAK,SAAS,MAAM;AAAA,QAC/C,KAAK,KAAK,OAAO;AAAA,MACrB,CAAC;AACD,aAAO;AAAA,IACX,SAAS,OAAO;AACZ,YAAM,IAAI,MAAM,+BAA+B,KAAK,EAAE;AAAA,IAC1D;AAAA,EACJ;AACJ;","names":[]}